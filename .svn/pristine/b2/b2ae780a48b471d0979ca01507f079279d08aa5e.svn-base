import Vue from 'vue'
import Vuex from 'vuex'
Vue.use(Vuex)
function isJson(str) {
  if (typeof str == 'string') {
    try {
      var obj=JSON.parse(str);
      if(typeof obj == 'object' && obj ){
        return true;
      }else{
        return false;
      }
    } catch(e) {
      console.log('error：'+str+'!!!'+e);
      return false;
    }
  }else{
    return false;
  }
}
const state = {
  //标签列表
  tabViews:window.getSession('tabViews') && isJson(window.getSession('tabViews'))?JSON.parse(window.getSession('tabViews')):[],
  //左侧二级菜单激活标题
  menu2Active:window.getSession('menu2Active')?window.getSession('menu2Active'):-1,
  //tabView激活标题
  tabViewActive:window.getSession('tabViewActive')?window.getSession('tabViewActive'):-1,
  callShow:false,
  homeAuth:false,
  //左侧菜单列表
  menuList:window.getSession('menuList') && isJson(window.getSession('menuList'))?JSON.parse(window.getSession('menuList')):[],
  //路由权限列表
  authList: window.getSession('authList') && isJson(window.getSession('authList'))?JSON.parse(window.getSession('authList')):{
    index:true,
    login:true,
    home:true,
    callRecords:false,
  },
  //部门列表
  departList:window.sessionStorage.getItem('departList') && isJson(window.sessionStorage.getItem('departList'))?JSON.parse(window.sessionStorage.getItem('departList')):[],
};
const mutations = {
  changeTabViews(state,n){
    state.tabViews = n;
  },
  cmenu2Active(state,n){
    state.menu2Active = n;
  },
  ctabViewActive(state,n){
    state.tabViewActive = n;
  },
  ccallShow(state,n){
    state.callShow = n;
  },
  chomeAuth(state,n){
    state.homeAuth = n;
  },
  getDepartList (state,n){
    // state.departList = n;
    window.sessionStorage.setItem('departList',JSON.stringify(n))
  }
}

const store = new Vuex.Store({
  state,
  mutations,
});

export default store
